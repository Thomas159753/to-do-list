/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";var e=Object.prototype.toString,t=Array.isArray||function(t){return"[object Array]"===e.call(t)};function a(e){return"function"==typeof e}function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function s(e,t){return null!=e&&"object"==typeof e&&t in e}var r=RegExp.prototype.test,i=/\S/;var o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},c=/\s*/,l=/\s+/,d=/\s*=/,p=/\s*\}/,h=/#|\^|\/|>|\{|&|=|!/;function f(e){this.string=e,this.tail=e,this.pos=0}function u(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function g(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}f.prototype.eos=function(){return""===this.tail},f.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var a=t[0];return this.tail=this.tail.substring(a.length),this.pos+=a.length,a},f.prototype.scanUntil=function(e){var t,a=this.tail.search(e);switch(a){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,a),this.tail=this.tail.substring(a)}return this.pos+=t.length,t},u.prototype.push=function(e){return new u(e,this)},u.prototype.lookup=function(e){var t,n,r,i=this.cache;if(i.hasOwnProperty(e))t=i[e];else{for(var o,c,l,d=this,p=!1;d;){if(e.indexOf(".")>0)for(o=d.view,c=e.split("."),l=0;null!=o&&l<c.length;)l===c.length-1&&(p=s(o,c[l])||(n=o,r=c[l],null!=n&&"object"!=typeof n&&n.hasOwnProperty&&n.hasOwnProperty(r))),o=o[c[l++]];else o=d.view[e],p=s(d.view,e);if(p){t=o;break}d=d.parent}i[e]=t}return a(t)&&(t=t.call(this.view)),t},g.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},g.prototype.parse=function(e,a){var s=this.templateCache,o=e+":"+(a||k.tags).join(":"),u=void 0!==s,g=u?s.get(o):void 0;return null==g&&(g=function(e,a){if(!e)return[];var s,o,u,g,m=!1,v=[],y=[],x=[],w=!1,I=!1,T="",S=0;function $(){if(w&&!I)for(;x.length;)delete y[x.pop()];else x=[];w=!1,I=!1}function b(e){if("string"==typeof e&&(e=e.split(l,2)),!t(e)||2!==e.length)throw new Error("Invalid tags: "+e);s=new RegExp(n(e[0])+"\\s*"),o=new RegExp("\\s*"+n(e[1])),u=new RegExp("\\s*"+n("}"+e[1]))}b(a||k.tags);for(var j,C,_,E,O,U,P=new f(e);!P.eos();){if(j=P.pos,_=P.scanUntil(s))for(var D=0,J=_.length;D<J;++D)g=E=_.charAt(D),function(e,t){return r.call(e,t)}(i,g)?(I=!0,m=!0,T+=" "):(x.push(y.length),T+=E),y.push(["text",E,j,j+1]),j+=1,"\n"===E&&($(),T="",S=0,m=!1);if(!P.scan(s))break;if(w=!0,C=P.scan(h)||"name",P.scan(c),"="===C?(_=P.scanUntil(d),P.scan(d),P.scanUntil(o)):"{"===C?(_=P.scanUntil(u),P.scan(p),P.scanUntil(o),C="&"):_=P.scanUntil(o),!P.scan(o))throw new Error("Unclosed tag at "+P.pos);if(O=">"==C?[C,_,j,P.pos,T,S,m]:[C,_,j,P.pos],S++,y.push(O),"#"===C||"^"===C)v.push(O);else if("/"===C){if(!(U=v.pop()))throw new Error('Unopened section "'+_+'" at '+j);if(U[1]!==_)throw new Error('Unclosed section "'+U[1]+'" at '+j)}else"name"===C||"{"===C||"&"===C?I=!0:"="===C&&b(_)}if($(),U=v.pop())throw new Error('Unclosed section "'+U[1]+'" at '+P.pos);return function(e){for(var t,a=[],n=a,s=[],r=0,i=e.length;r<i;++r)switch((t=e[r])[0]){case"#":case"^":n.push(t),s.push(t),n=t[4]=[];break;case"/":s.pop()[5]=t[2],n=s.length>0?s[s.length-1][4]:a;break;default:n.push(t)}return a}(function(e){for(var t,a,n=[],s=0,r=e.length;s<r;++s)(t=e[s])&&("text"===t[0]&&a&&"text"===a[0]?(a[1]+=t[1],a[3]=t[3]):(n.push(t),a=t));return n}(y))}(e,a),u&&s.set(o,g)),g},g.prototype.render=function(e,t,a,n){var s=this.getConfigTags(n),r=this.parse(e,s),i=t instanceof u?t:new u(t,void 0);return this.renderTokens(r,i,a,e,n)},g.prototype.renderTokens=function(e,t,a,n,s){for(var r,i,o,c="",l=0,d=e.length;l<d;++l)o=void 0,"#"===(i=(r=e[l])[0])?o=this.renderSection(r,t,a,n,s):"^"===i?o=this.renderInverted(r,t,a,n,s):">"===i?o=this.renderPartial(r,t,a,s):"&"===i?o=this.unescapedValue(r,t):"name"===i?o=this.escapedValue(r,t,s):"text"===i&&(o=this.rawValue(r)),void 0!==o&&(c+=o);return c},g.prototype.renderSection=function(e,n,s,r,i){var o=this,c="",l=n.lookup(e[1]);if(l){if(t(l))for(var d=0,p=l.length;d<p;++d)c+=this.renderTokens(e[4],n.push(l[d]),s,r,i);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)c+=this.renderTokens(e[4],n.push(l),s,r,i);else if(a(l)){if("string"!=typeof r)throw new Error("Cannot use higher-order sections without the original template");null!=(l=l.call(n.view,r.slice(e[3],e[5]),(function(e){return o.render(e,n,s,i)})))&&(c+=l)}else c+=this.renderTokens(e[4],n,s,r,i);return c}},g.prototype.renderInverted=function(e,a,n,s,r){var i=a.lookup(e[1]);if(!i||t(i)&&0===i.length)return this.renderTokens(e[4],a,n,s,r)},g.prototype.indentPartial=function(e,t,a){for(var n=t.replace(/[^ \t]/g,""),s=e.split("\n"),r=0;r<s.length;r++)s[r].length&&(r>0||!a)&&(s[r]=n+s[r]);return s.join("\n")},g.prototype.renderPartial=function(e,t,n,s){if(n){var r=this.getConfigTags(s),i=a(n)?n(e[1]):n[e[1]];if(null!=i){var o=e[6],c=e[5],l=e[4],d=i;0==c&&l&&(d=this.indentPartial(i,l,o));var p=this.parse(d,r);return this.renderTokens(p,t,n,d,s)}}},g.prototype.unescapedValue=function(e,t){var a=t.lookup(e[1]);if(null!=a)return a},g.prototype.escapedValue=function(e,t,a){var n=this.getConfigEscape(a)||k.escape,s=t.lookup(e[1]);if(null!=s)return"number"==typeof s&&n===k.escape?String(s):n(s)},g.prototype.rawValue=function(e){return e[1]},g.prototype.getConfigTags=function(e){return t(e)?e:e&&"object"==typeof e?e.tags:void 0},g.prototype.getConfigEscape=function(e){return e&&"object"==typeof e&&!t(e)?e.escape:void 0};var k={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){m.templateCache=e},get templateCache(){return m.templateCache}},m=new g;k.clearCache=function(){return m.clearCache()},k.parse=function(e,t){return m.parse(e,t)},k.render=function(e,a,n,s){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+(t(r=e)?"array":typeof r)+'" was given as the first argument for mustache#render(template, view, partials)');var r;return m.render(e,a,n,s)},k.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return o[e]}))},k.Scanner=f,k.Context=u,k.Writer=g;const v=k,y=class{constructor(e,t,a=[],n=[]){this.name=e,this.tasks=a,this.completedTasks=n,this.dataIndex=t,this.cacheDom()}cacheDom(){this.$nav=$(".nav-bar"),this.$projectModule=this.$nav.find("#projectModule"),this.$ul=this.$projectModule.find("ul"),this.$tasksPreview=$(".tasks-preview"),this.$taskUl=this.$tasksPreview.find("#tasks-list")}render(e,t){const a='\n      <li class="item" data-index="{{dataIndex}}">\n        <span class="task_icon"><i class="fa-regular fa-circle"></i></span>\n        <span class="task_text">{{task}}</span>\n        <input class="date" type="date" id="dateInput" name="date" value="{{date}}">\n      </li>\n    ';"project"===e?this.$ul.append(v.render('\n    <li class="project-li item" data-index="{{dataIndex}}">\n        <span class="btn__icon"><i class="fa-solid fa-list"></i></span>\n        <span class="btn__text">{{name}}</span>\n        <span class="btn__icon"><i class="fa-regular fa-trash-can"></i></span>\n    </li>\n    ',{name:this.name,dataIndex:this.dataIndex})):"filter"===e?(this.$taskUl.empty(),t.forEach((e=>{this.$taskUl.append(v.render(a,{task:e.name,dataIndex:e.dataIndex,date:e.date||""}))}))):"task"===e&&(this.$taskUl.empty(),this.tasks.forEach((e=>{this.$taskUl.append(v.render(a,{task:e.name,dataIndex:e.dataIndex,date:e.date||""}))})),this.completedTasks.forEach((e=>{this.$taskUl.append(v.render('\n    <li class="item" data-index="{{dataIndex}}">\n      <span class="task_icon"><i class="fa-regular fa-check-circle"></i></span>\n      <span class="task_text">{{task}}</span>\n      <input class="date" type="date" id="dateInput" name="date" value="{{date}}">\n    </li>\n  ',{task:e.name,dataIndex:e.dataIndex,date:e.date||""}))})))}addProjectTask(e,t){this.tasks.push({name:e,completed:!1,dataIndex:t,date:null})}addDate(e,t){e.date=t.toString()}completeTask(e,t){if(!1===t.completed){const t=this.tasks.splice(e,1)[0];t.completed=!0,this.completedTasks.push(t)}else{const t=this.completedTasks.splice(e,1)[0];t.completed=!1,this.tasks.push(t)}}deleteProject(){this.tasks=[],this.completedTasks=[]}},x=function(e,t,a){const n=$(e),s=$(t);"none"===n.css("display")&&"flex"===s.css("display")&&!1===a?(n.css("display","flex"),s.css("display","none")):!0===a?s.css("display","none"):(n.css("display","none"),s.css("display","flex"))},w=function(e,t){const a=new Date,n=[];for(let e=0;e<localStorage.length;e++){const t=localStorage.key(e),a=localStorage.getItem(t);let s=null;a&&(s=JSON.parse(a)),s&&n.push(s)}let s=[];return n.forEach((n=>{let r=[];"today"===e?r=n.tasks.filter((e=>new Date(e.date).toLocaleDateString()===a.toLocaleDateString())):"upcoming"===e?r=n.tasks.filter((e=>new Date(e.date)>a)):"all"===e?r=[...n.tasks]:"search"===e&&(r=n.tasks.filter((e=>e.name===t))),s=[...s,...r]})),s};!function(){const e=$(".nav-bar"),t=e.find("#new_project"),a=e.find("#inbox"),n=e.find("#today"),s=e.find("#upcoming"),r=e.find("#search"),i=e.find("#project_form"),o=i.find("#project_input"),c=(i.find(".btn_add_project"),i.find("#btn_cancel_project"),e.find("ul")),l=$(".tasks-preview"),d=l.find(".add-task-show"),p=l.find(".task-input-div"),h=l.find("#task_input"),f=l.find(".btn_add_task"),u=l.find("#tasks-list"),g=l.find(".task-header");let k=JSON.parse(localStorage.getItem("index"))||0;0===k&&localStorage.setItem("index",JSON.stringify(k));let m=null;const v=e=>{const t=$(e.currentTarget).closest(".item").data("index"),a=$(e.currentTarget).closest(".item");if($(e.currentTarget).hasClass("project-li")){const e=JSON.parse(localStorage.getItem(t));m=new y(e.name,e.dataIndex,e.tasks,e.completedTasks),T(m,"task")}else if($(e.currentTarget).hasClass("fa-circle")||$(e.currentTarget).hasClass("fa-check-circle")||$(e.currentTarget).hasClass("date")){let a,n;if($(e.currentTarget).hasClass("fa-circle")||$(e.currentTarget).hasClass("date")?(a=m.tasks.findIndex((e=>e.dataIndex===t)),n=m.tasks.find((e=>e.dataIndex===t))):(a=m.completedTasks.findIndex((e=>e.dataIndex===t)),n=m.completedTasks.find((e=>e.dataIndex===t))),n)if($(e.currentTarget).hasClass("date")){const t=$(e.currentTarget).val();m.addDate(n,t)}else m.completeTask(a,n),T(m,"task")}else if($(e.currentTarget).hasClass("fa-trash-can")){const e=JSON.parse(localStorage.getItem(t)),n=new y(e.name,e.dataIndex,e.tasks,e.completedTasks);I(n,a)}localStorage.setItem(`${m.dataIndex}`,JSON.stringify(m))},I=(e,t)=>{e.deleteProject(),t.remove(),localStorage.removeItem(e.dataIndex),T(e,"delete")},T=(e,t,a)=>{if("delete"===t)g.html(""),x(void 0,d,!0),u.empty(),e.render(t);else if("project"===t)for(let e=0;e<localStorage.length;e++){const t=localStorage.key(e),a=localStorage.getItem(t);let n,s=null;a&&(s=JSON.parse(a)),s instanceof Object&&(n=new y(s.name,s.dataIndex,s.tasks,s.completedTasks),n.render("project"))}else"filter"===t?(g.html(""),x(void 0,d,!0),x(void 0,p,!0),u.empty(),e.render(t,a)):(g.html(e.name),f.off("click").on("click",(()=>(e=>{e.addProjectTask(h.val(),k++),localStorage.setItem("index",JSON.stringify(k)),h.val(""),localStorage.setItem(`${e.dataIndex}`,JSON.stringify(e)),T(e,"task")})(e))),x(p,d),e.render(t))};T(void 0,"project"),i.on("submit",(e=>{e.preventDefault(),(()=>{const e=new y(o.val(),k++);localStorage.setItem("index",JSON.stringify(k)),e.render("project"),o.val(""),x(i,t),localStorage.setItem(`${e.dataIndex}`,JSON.stringify(e))})()})),n.on("click",(()=>T(m,"filter",w("today")))),a.on("click",(()=>T(m,"filter",w("all")))),s.on("click",(()=>T(m,"filter",w("upcoming")))),r.on("input",(()=>{T(m,"filter",w("search",r.val()))})),c.on("click","i.fa-trash-can",(e=>{e.stopPropagation(),v(e)})),c.on("click","li.project-li",(e=>{v(e)})),u.on("click","i.fa-circle, i.fa-check-circle",(e=>{v(e,e.currentTarget)})),u.on("change","input.date",(e=>{v(e,e.currentTarget)})),t.on("click",(()=>x(i,t,!1))),d.on("click",(()=>x(p,d,!1)))}()})();